<!DOCTYPE html>
<html>
<head>
  <title>Assistant</title>
  <meta charset="utf-8"/>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; margin: 2em; }
    #log { border: 1px solid #ccc; padding: 1em; background: white; height: 200px; overflow-y: auto; }
    button { margin: 0.5em; padding: 0.5em 1em; }
  </style>
</head>
<body>
  <h1>Voice Assistant</h1>
  <div id="log"></div>
  <button onclick="startRec()">üéôÔ∏è Start</button>
  <audio id="player" controls></audio>

  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <script>
    const socket = io();

    function log(msg) {
      const logEl = document.getElementById("log");
      logEl.innerHTML += "<div>" + msg + "</div>";
      logEl.scrollTop = logEl.scrollHeight;
    }

    function startRec() {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = "en-US";
      recognition.onresult = (event) => {
        const text = event.results[0][0].transcript;
        log("You: " + text);
        socket.emit("speech_in", { text: text });
      };
      recognition.start();
    }

    socket.on("speech_out", (data) => {
      log("AI: " + data.text);
      const player = document.getElementById("player");
      player.src = data.audio;
      player.play();
    });
  </script>
</body>
</html>
